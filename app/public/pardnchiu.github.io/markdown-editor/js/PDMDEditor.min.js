function MDViewerCss(t){}function randomKey(){let t="{{";for(let e=0;e<64;e++)t+=String(keys.sort(()=>Math.random()-.5)[0]);return t+="}}",keyMap.has(t)?randomKey():t}class MDNav{constructor(t){const e="section#md-nav"._();this.body=e}}let tag_path,tag_target;export class MDViewer{constructor(t){let e="PDMDViewer";null!=t&&(e=null==t.id||t.id.$$mt?e:t.id,this.pre=null==t.pre?"":t.pre,this.delay=null==t.delay?300:t.delay,tag_path=null==t.tag_path?null:t.tag_path,tag_target=null==t.tag_target?"_blank":t.tag_target),this.body=`section#${e}.md-viewer`._()}get editor(){return this.edit}set editor(t){this.edit=t}updateRowNum(){this.body.$selAll("div").forEach((t,e)=>{t._attr({index:e+1})})}getMdTxt(){if(!this.edit)return"";var t="";return this.edit.body.$childAll.forEach((e,i)=>{var n=e.innerText.__(/[\u00A0\u0020]/g," ");n.$$mt?t+="\n":t+=`${n}\n`}),`\n${t.trim()}\n`}init(t){this.updateRowNum();let e=this.pre,i=this.body.scrollTop;this.editorTimer&&clearTimeout(this.editorTimer),this.editorTimer=setTimeout(()=>{if(clearTimeout(this.editorTimer),this.editorTimer=null,e&&this.body.innerHTML&&e===this.body.innerHTML)return;let n=t?`\n${t}`:"";n||(n=this.edit&&this.edit.body.innerText?this.getMdTxt():e),n=`\n${n}\n`,n=n.mdToHtml();let s,l="temp"._();null!=n&&`${n}\n`.$$(/(.+\n)+/g)&&`${n}\n`.$fit(/(.+\n)+/g).forEach(t=>{if(t.trim().$$(/^[\u00A0\u0020]*\<(.+\n?)\>$/)){let e="template"._(t);l._child(e.content)}else t.split(/\n/).forEach(t=>{if(!t.$$mt)if(t.trim().$$(/^[\u00A0\u0020]*\<(.+\n?)\>$/)){let e="template"._(t);l._child(e.content)}else l._child(["p"._(t)])})}),this.body.__child(l),this.body.$selAll("button.copy").forEach(t=>{t._click(async function(){clearTimeout(s);let t=this.$pre(0).$child(0).innerText;try{await navigator.clipboard.writeText(t),this.$parent(0)._class("success"),s=setTimeout(()=>{this.$parent(0).class_("success")},1e3)}catch(t){console.error(t),this.$parent(0)._class("error")}})}),PR.prettyPrint(),setTimeout(()=>{this.body.scrollTop=i},1)},this.delay)}}!function(){function t(t){function e(){try{s.doScroll("left")}catch(t){return void i.setTimeout(e,50)}l("poll")}function l(e){"readystatechange"==e.type&&"complete"!=n.readyState||(("load"==e.type?i:n)[a](d+e.type,l,!1),!o&&(o=!0)&&t.call(i,e.type||e))}var r=n.addEventListener,o=!1,h=!0,c=r?"addEventListener":"attachEvent",a=r?"removeEventListener":"detachEvent",d=r?"":"on";if("complete"==n.readyState)t.call(i,"lazy");else{if(n.createEventObject&&s.doScroll){try{h=!i.frameElement}catch(t){}h&&e()}n[c](d+"DOMContentLoaded",l,!1),n[c](d+"readystatechange",l,!1),i[c](d+"load",l,!1)}}function e(){d&&t(function(){var t=f.length;$(t?function(){for(var e=0;e<t;++e)(function(t){i.setTimeout(function(){i.exports[f[t]].apply(i,arguments)},0)})(e)}:void 0)})}for(var i=window,n=document,s=n.documentElement,l=n.head||n.getElementsByTagName("head")[0]||s,r="",o=n.getElementsByTagName("script"),h=o.length;0<=--h;){var c=o[h],a=c.src.match(/^[^?#]*\/run_prettify\.js(\?[^#]*)?(?:#.*)?$/);if(a){r=a[1]||"",c.parentNode.removeChild(c);break}}var d=!0,u=[],p=[],f=[];for(r.replace(/[?&]([^&=]+)=([^&]+)/g,function(t,e,i){i=decodeURIComponent(i),e=decodeURIComponent(e),"autorun"==e?d=!/^[0fn]/i.test(i):"lang"==e?u.push(i):"skin"==e?p.push(i):"callback"==e&&f.push(i)}),h=0,r=u.length;h<r;++h)(function(){var t=n.createElement("script");t.onload=t.onerror=t.onreadystatechange=function(){!t||t.readyState&&!/loaded|complete/.test(t.readyState)||(t.onerror=t.onload=t.onreadystatechange=null,--m,m||i.setTimeout(e,0),t.parentNode&&t.parentNode.removeChild(t),t=null)},t.type="text/javascript",t.src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/lang-"+encodeURIComponent(u[h])+".js",l.insertBefore(t,l.firstChild)})(u[h]);var m=u.length;for(o=[],h=0,r=p.length;h<r;++h)o.push("https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/skins/"+encodeURIComponent(p[h])+".css");o.push("https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/prettify.css"),function(t){function e(s){if(s!==i){var r=n.createElement("link");r.rel="stylesheet",r.type="text/css",s+1<i&&(r.error=r.onerror=function(){e(s+1)}),r.href=t[s],l.appendChild(r)}}var i=t.length;e(0)}(o);var g,$=("undefined"!=typeof window&&(window.PR_SHOULD_USE_CONTINUATION=!0),function(){function t(t){function e(t){var e=t.charCodeAt(0);if(92!==e)return e;var i=t.charAt(1);return(e=d[i])?e:"0"<=i&&"7">=i?parseInt(t.substring(1),8):"u"===i||"x"===i?parseInt(t.substring(2),16):t.charCodeAt(1)}function i(t){return 32>t?(16>t?"\\x0":"\\x")+t.toString(16):(t=String.fromCharCode(t),"\\"===t||"-"===t||"]"===t||"^"===t?"\\"+t:t)}function n(t){var n=t.substring(1,t.length-1).match(RegExp("\\\\u[0-9A-Fa-f]{4}|\\\\x[0-9A-Fa-f]{2}|\\\\[0-3][0-7]{0,2}|\\\\[0-7]{1,2}|\\\\[\\s\\S]|-|[^-\\\\]","g"));t=[];var s="^"===n[0],l=["["];s&&l.push("^"),s=s?1:0;for(var r=n.length;s<r;++s){var o,h=n[s];/\\[bdsw]/i.test(h)?l.push(h):(h=e(h),s+2<r&&"-"===n[s+1]?(o=e(n[s+2]),s+=2):o=h,t.push([h,o]),65>o||122<h||(65>o||90<h||t.push([32|Math.max(65,h),32|Math.min(o,90)]),97>o||122<h||t.push([-33&Math.max(97,h),-33&Math.min(o,122)])))}for(t.sort(function(t,e){return t[0]-e[0]||e[1]-t[1]}),n=[],r=[],s=0;s<t.length;++s)h=t[s],h[0]<=r[1]+1?r[1]=Math.max(r[1],h[1]):n.push(r=h);for(s=0;s<n.length;++s)h=n[s],l.push(i(h[0])),h[1]>h[0]&&(h[1]+1>h[0]&&l.push("-"),l.push(i(h[1])));return l.push("]"),l.join("")}function s(t){for(var e=t.source.match(RegExp("(?:\\[(?:[^\\x5C\\x5D]|\\\\[\\s\\S])*\\]|\\\\u[A-Fa-f0-9]{4}|\\\\x[A-Fa-f0-9]{2}|\\\\[0-9]+|\\\\[^ux0-9]|\\(\\?[:!=]|[\\(\\)\\^]|[^\\x5B\\x5C\\(\\)\\^]+)","g")),s=e.length,o=[],h=0,c=0;h<s;++h){var a=e[h];"("===a?++c:"\\"===a.charAt(0)&&(a=+a.substring(1))&&(a<=c?o[a]=-1:e[h]=i(a))}for(h=1;h<o.length;++h)-1===o[h]&&(o[h]=++l);for(c=h=0;h<s;++h)a=e[h],"("===a?(++c,o[c]||(e[h]="(?:")):"\\"===a.charAt(0)&&(a=+a.substring(1))&&a<=c&&(e[h]="\\"+o[a]);for(h=0;h<s;++h)"^"===e[h]&&"^"!==e[h+1]&&(e[h]="");if(t.ignoreCase&&r)for(h=0;h<s;++h)a=e[h],t=a.charAt(0),2<=a.length&&"["===t?e[h]=n(a):"\\"!==t&&(e[h]=a.replace(/[a-zA-Z]/g,function(t){return t=t.charCodeAt(0),"["+String.fromCharCode(-33&t,32|t)+"]"}));return e.join("")}for(var l=0,r=!1,o=!1,h=0,c=t.length;h<c;++h){var a=t[h];if(a.ignoreCase)o=!0;else if(/[a-z]/i.test(a.source.replace(/\\u[0-9a-f]{4}|\\x[0-9a-f]{2}|\\[^ux]/gi,""))){r=!0,o=!1;break}}var d={b:8,t:9,n:10,v:11,f:12,r:13},u=[];for(h=0,c=t.length;h<c;++h){if(a=t[h],a.global||a.multiline)throw Error(""+a);u.push("(?:"+s(a)+")")}return new RegExp(u.join("|"),o?"gi":"g")}function e(t,e){function i(t){var h=t.nodeType;if(1==h){if(!n.test(t.className)){for(h=t.firstChild;h;h=h.nextSibling)i(h);h=t.nodeName.toLowerCase(),"br"!==h&&"li"!==h||(s[o]="\n",r[o<<1]=l++,r[o++<<1|1]=t)}}else 3!=h&&4!=h||(h=t.nodeValue,h.length&&(h=e?h.replace(/\r\n?/g,"\n"):h.replace(/[ \t\r\n]+/g," "),s[o]=h,r[o<<1]=l,l+=h.length,r[o++<<1|1]=t))}var n=/(?:^|\s)nocode(?:\s|$)/,s=[],l=0,r=[],o=0;return i(t),{a:s.join("").replace(/\n$/,""),c:r}}function i(t,e,i,n,s){i&&(t={h:t,l:1,j:null,m:null,a:i,c:null,i:e,g:null},n(t),s.push.apply(s,t.g))}function n(t){for(var e=void 0,i=t.firstChild;i;i=i.nextSibling){var n=i.nodeType;e=1===n?e?t:i:3===n&&b.test(i.nodeValue)?t:e}return e===t?void 0:e}function s(e,n){function s(t){for(var e=t.i,c=t.h,a=[e,"pln"],d=0,u=t.a.match(l)||[],p={},f=0,m=u.length;f<m;++f){var g,$=u[f],_=p[$],y=void 0;if("string"==typeof _)g=!1;else{var b=r[$.charAt(0)];if(b)y=$.match(b[1]),_=b[0];else{for(g=0;g<o;++g)if(b=n[g],y=$.match(b[1])){_=b[0];break}y||(_="pln")}!(g=5<=_.length&&"lang-"===_.substring(0,5))||y&&"string"==typeof y[1]||(g=!1,_="src"),g||(p[$]=_)}if(b=d,d+=$.length,g){g=y[1];var v=$.indexOf(g),w=v+g.length;y[2]&&(w=$.length-y[2].length,v=w-g.length),_=_.substring(5),i(c,e+b,$.substring(0,v),s,a),i(c,e+b+v,g,h(_,g),a),i(c,e+b+w,$.substring(w),s,a)}else a.push(e+b,_)}t.g=a}var l,r={};(function(){for(var i=e.concat(n),s=[],o={},h=0,c=i.length;h<c;++h){var a=i[h],d=a[3];if(d)for(var u=d.length;0<=--u;)r[d.charAt(u)]=a;a=a[1],d=""+a,o.hasOwnProperty(d)||(s.push(a),o[d]=null)}s.push(/[\0-\uffff]/),l=t(s)})();var o=n.length;return s}function l(t){var e=[],i=[];t.tripleQuotedStrings?e.push(["str",/^(?:\'\'\'(?:[^\'\\]|\\[\s\S]|\'{1,2}(?=[^\']))*(?:\'\'\'|$)|\"\"\"(?:[^\"\\]|\\[\s\S]|\"{1,2}(?=[^\"]))*(?:\"\"\"|$)|\'(?:[^\\\']|\\[\s\S])*(?:\'|$)|\"(?:[^\\\"]|\\[\s\S])*(?:\"|$))/,null,"'\""]):t.multiLineStrings?e.push(["str",/^(?:\'(?:[^\\\']|\\[\s\S])*(?:\'|$)|\"(?:[^\\\"]|\\[\s\S])*(?:\"|$)|\`(?:[^\\\`]|\\[\s\S])*(?:\`|$))/,null,"'\"`"]):e.push(["str",/^(?:\'(?:[^\\\'\r\n]|\\.)*(?:\'|$)|\"(?:[^\\\"\r\n]|\\.)*(?:\"|$))/,null,"\"'"]),t.verbatimStrings&&i.push(["str",/^@\"(?:[^\"]|\"\")*(?:\"|$)/,null]);var n=t.hashComments;if(n&&(t.cStyleComments?(1<n?e.push(["com",/^#(?:##(?:[^#]|#(?!##))*(?:###|$)|.*)/,null,"#"]):e.push(["com",/^#(?:(?:define|e(?:l|nd)if|else|error|ifn?def|include|line|pragma|undef|warning)\b|[^\r\n]*)/,null,"#"]),i.push(["str",/^<(?:(?:(?:\.\.\/)*|\/?)(?:[\w-]+(?:\/[\w-]+)+)?[\w-]+\.h(?:h|pp|\+\+)?|[a-z]\w*)>/,null])):e.push(["com",/^#[^\r\n]*/,null,"#"])),t.cStyleComments&&(i.push(["com",/^\/\/[^\r\n]*/,null]),i.push(["com",/^\/\*[\s\S]*?(?:\*\/|$)/,null])),n=t.regexLiterals){var l=(n=1<n?"":"\n\r")?".":"[\\S\\s]";i.push(["lang-regex",RegExp("^(?:^^\\.?|[+-]|[!=]=?=?|\\#|%=?|&&?=?|\\(|\\*=?|[+\\-]=|->|\\/=?|::?|<<?=?|>>?>?=?|,|;|\\?|@|\\[|~|{|\\^\\^?=?|\\|\\|?=?|break|case|continue|delete|do|else|finally|instanceof|return|throw|try|typeof)\\s*(/(?=[^/*"+n+"])(?:[^/\\x5B\\x5C"+n+"]|\\x5C"+l+"|\\x5B(?:[^\\x5C\\x5D"+n+"]|\\x5C"+l+")*(?:\\x5D|$))+/)")])}return(n=t.types)&&i.push(["typ",n]),n=(""+t.keywords).replace(/^ | $/g,""),n.length&&i.push(["kwd",new RegExp("^(?:"+n.replace(/[\s,]+/g,"|")+")\\b"),null]),e.push(["pln",/^\s+/,null," \r\n\t "]),n="^.[^\\s\\w.$@'\"`/\\\\]*",t.regexLiterals&&(n+="(?!s*/)"),i.push(["lit",/^@[a-z_$][a-z_$@0-9]*/i,null],["typ",/^(?:[@_]?[A-Z]+[a-z][A-Za-z_$@0-9]*|\w+_t\b)/,null],["pln",/^[a-z_$][a-z_$@0-9]*/i,null],["lit",/^(?:0x[a-f0-9]+|(?:\d(?:_\d+)*\d*(?:\.\d*)?|\.\d\+)(?:e[+\-]?\d+)?)[a-z]*/i,null,"0123456789"],["pln",/^\\[\s\S]?/,null],["pun",new RegExp(n),null]),s(e,i)}function r(t,e,i){function n(t){var e=t.nodeType;if(1!=e||l.test(t.className)){if((3==e||4==e)&&i){var h=t.nodeValue,c=h.match(r);c&&(e=h.substring(0,c.index),t.nodeValue=e,(h=h.substring(c.index+c[0].length))&&t.parentNode.insertBefore(o.createTextNode(h),t.nextSibling),s(t),e||t.parentNode.removeChild(t))}}else if("br"===t.nodeName.toLowerCase())s(t),t.parentNode&&t.parentNode.removeChild(t);else for(t=t.firstChild;t;t=t.nextSibling)n(t)}function s(t){function e(t,i){var n=i?t.cloneNode(!1):t,s=t.parentNode;if(s){s=e(s,1);var l=t.nextSibling;s.appendChild(n);for(var r=l;r;r=l)l=r.nextSibling,s.appendChild(r)}return n}for(;!t.nextSibling;)if(t=t.parentNode,!t)return;t=e(t.nextSibling,0);for(var i;(i=t.parentNode)&&1===i.nodeType;)t=i;c.push(t)}for(var l=/(?:^|\s)nocode(?:\s|$)/,r=/\r\n?|\n/,o=t.ownerDocument,h=o.createElement("li");t.firstChild;)h.appendChild(t.firstChild);for(var c=[h],a=0;a<c.length;++a)n(c[a]);e===(0|e)&&c[0].setAttribute("value",e);var d=o.createElement("ol");d.className="linenums",e=Math.max(0,e-1|0)||0,a=0;for(var u=c.length;a<u;++a)h=c[a],h.className="L"+(a+e)%10,h.firstChild||h.appendChild(o.createTextNode(" ")),d.appendChild(h);t.appendChild(d)}function o(t,e){for(var i=e.length;0<=--i;){var n=e[i];w.hasOwnProperty(n)?a.console&&console.warn("cannot override language handler %s",n):w[n]=t}}function h(t,e){return t&&w.hasOwnProperty(t)||(t=/^\s*</.test(e)?"default-markup":"default-code"),w[t]}function c(t){var i=t.j;try{var n=e(t.h,t.l),s=n.a;t.a=s,t.c=n.c,t.i=0,h(i,s)(t);var l,r,o=/\bMSIE\s(\d+)/.exec(navigator.userAgent),c=(o=o&&8>=+o[1],i=/\n/g,t.a),d=c.length,u=(n=0,t.c),p=u.length,f=(s=0,t.g),m=f.length,g=0;for(f[m]=d,r=l=0;r<m;)f[r]!==f[r+2]?(f[l++]=f[r++],f[l++]=f[r++]):r+=2;for(m=l,r=l=0;r<m;){for(var $=f[r],_=f[r+1],y=r+2;y+2<=m&&f[y+1]===_;)y+=2;f[l++]=$,f[l++]=_,r=y}f.length=l;var b=t.h;t="",b&&(t=b.style.display,b.style.display="none");try{for(;s<p;){var v,w=u[s+2]||d,x=f[g+2]||d,S=(y=Math.min(w,x),u[s+1]);if(1!==S.nodeType&&(v=c.substring(n,y))){o&&(v=v.replace(i,"\r")),S.nodeValue=v;var T=S.ownerDocument,C=T.createElement("span");C.className=f[g+1];var k=S.parentNode;k.replaceChild(C,S),C.appendChild(S),n<w&&(u[s+1]=S=T.createTextNode(c.substring(y,w)),k.insertBefore(S,C.nextSibling))}n=y,n>=w&&(s+=2),n>=x&&(g+=2)}}finally{b&&(b.style.display=t)}}catch(t){a.console&&console.log(t&&t.stack||t)}}var a="undefined"!=typeof window?window:{},d=["break,continue,do,else,for,if,return,while"],u=[[d,"auto,case,char,const,default,double,enum,extern,float,goto,inline,int,long,register,restrict,short,signed,sizeof,static,struct,switch,typedef,union,unsigned,void,volatile"],"catch,class,delete,false,import,new,operator,private,protected,public,this,throw,true,try,typeof"],p=[u,"alignas,alignof,align_union,asm,axiom,bool,concept,concept_map,const_cast,constexpr,decltype,delegate,dynamic_cast,explicit,export,friend,generic,late_check,mutable,namespace,noexcept,noreturn,nullptr,property,reinterpret_cast,static_assert,static_cast,template,typeid,typename,using,virtual,where"],f=[u,"abstract,assert,boolean,byte,extends,finally,final,implements,import,instanceof,interface,null,native,package,strictfp,super,synchronized,throws,transient"],m=[u,"abstract,add,alias,as,ascending,async,await,base,bool,by,byte,checked,decimal,delegate,descending,dynamic,event,finally,fixed,foreach,from,get,global,group,implicit,in,interface,internal,into,is,join,let,lock,null,object,out,override,orderby,params,partial,readonly,ref,remove,sbyte,sealed,select,set,stackalloc,string,select,uint,ulong,unchecked,unsafe,ushort,value,var,virtual,where,yield"],$=(u=[u,"abstract,async,await,constructor,debugger,enum,eval,export,from,function,get,import,implements,instanceof,interface,let,null,of,set,undefined,var,with,yield,Infinity,NaN"],[d,"and,as,assert,class,def,del,elif,except,exec,finally,from,global,import,in,is,lambda,nonlocal,not,or,pass,print,raise,try,with,yield,False,True,None"]),_=[d,"alias,and,begin,case,class,def,defined,elsif,end,ensure,false,in,module,next,nil,not,or,redo,rescue,retry,self,super,then,true,undef,unless,until,when,yield,BEGIN,END"],y=(d=[d,"case,done,elif,esac,eval,fi,function,in,local,set,then,until"],/^(DIR|FILE|array|vector|(de|priority_)?queue|(forward_)?list|stack|(const_)?(reverse_)?iterator|(unordered_)?(multi)?(set|map)|bitset|u?(int|float)\d*)\b/),b=/\S/,v=l({keywords:[p,m,f,u,"caller,delete,die,do,dump,elsif,eval,exit,foreach,for,goto,if,import,last,local,my,next,no,our,print,package,redo,require,sub,undef,unless,until,use,wantarray,while,BEGIN,END",$,_,d],hashComments:!0,cStyleComments:!0,multiLineStrings:!0,regexLiterals:!0}),w={};o(v,["default-code"]),o(s([],[["pln",/^[^<?]+/],["dec",/^<!\w[^>]*(?:>|$)/],["com",/^<\!--[\s\S]*?(?:-\->|$)/],["lang-",/^<\?([\s\S]+?)(?:\?>|$)/],["lang-",/^<%([\s\S]+?)(?:%>|$)/],["pun",/^(?:<[%?]|[%?]>)/],["lang-",/^<xmp\b[^>]*>([\s\S]+?)<\/xmp\b[^>]*>/i],["lang-js",/^<script\b[^>]*>([\s\S]*?)(<\/script\b[^>]*>)/i],["lang-css",/^<style\b[^>]*>([\s\S]*?)(<\/style\b[^>]*>)/i],["lang-in.tag",/^(<\/?[a-z][^<>]*>)/i]]),"default-markup htm html mxml xhtml xml xsl".split(" ")),o(s([["pln",/^[\s]+/,null," \t\r\n"],["atv",/^(?:\"[^\"]*\"?|\'[^\']*\'?)/,null,"\"'"]],[["tag",/^^<\/?[a-z](?:[\w.:-]*\w)?|\/?>$/i],["atn",/^(?!style[\s=]|on)[a-z](?:[\w:-]*\w)?/i],["lang-uq.val",/^=\s*([^>\'\"\s]*(?:[^>\'\"\s\/]|\/(?=\s)))/],["pun",/^[=<>\/]+/],["lang-js",/^on\w+\s*=\s*\"([^\"]+)\"/i],["lang-js",/^on\w+\s*=\s*\'([^\']+)\'/i],["lang-js",/^on\w+\s*=\s*([^\"\'>\s]+)/i],["lang-css",/^style\s*=\s*\"([^\"]+)\"/i],["lang-css",/^style\s*=\s*\'([^\']+)\'/i],["lang-css",/^style\s*=\s*([^\"\'>\s]+)/i]]),["in.tag"]),o(s([],[["atv",/^[\s\S]+/]]),["uq.val"]),o(l({keywords:p,hashComments:!0,cStyleComments:!0,types:y}),"c cc cpp cxx cyc m".split(" ")),o(l({keywords:"null,true,false"}),["json"]),o(l({keywords:m,hashComments:!0,cStyleComments:!0,verbatimStrings:!0,types:y}),["cs"]),o(l({keywords:f,cStyleComments:!0}),["java"]),o(l({keywords:d,hashComments:!0,multiLineStrings:!0}),["bash","bsh","csh","sh"]),o(l({keywords:$,hashComments:!0,multiLineStrings:!0,tripleQuotedStrings:!0}),["cv","py","python"]),o(l({keywords:"caller,delete,die,do,dump,elsif,eval,exit,foreach,for,goto,if,import,last,local,my,next,no,our,print,package,redo,require,sub,undef,unless,until,use,wantarray,while,BEGIN,END",hashComments:!0,multiLineStrings:!0,regexLiterals:2}),["perl","pl","pm"]),o(l({keywords:_,hashComments:!0,multiLineStrings:!0,regexLiterals:!0}),["rb","ruby"]),o(l({keywords:u,cStyleComments:!0,regexLiterals:!0}),["javascript","js","ts","typescript"]),o(l({keywords:"all,and,by,catch,class,else,extends,false,finally,for,if,in,is,isnt,loop,new,no,not,null,of,off,on,or,return,super,then,throw,true,try,unless,until,when,while,yes",hashComments:3,cStyleComments:!0,multilineStrings:!0,tripleQuotedStrings:!0,regexLiterals:!0}),["coffee"]),o(s([],[["str",/^[\s\S]+/]]),["regex"]);var x=a.PR={createSimpleLexer:s,registerLangHandler:o,sourceDecorator:l,PR_ATTRIB_NAME:"atn",PR_ATTRIB_VALUE:"atv",PR_COMMENT:"com",PR_DECLARATION:"dec",PR_KEYWORD:"kwd",PR_LITERAL:"lit",PR_NOCODE:"nocode",PR_PLAIN:"pln",PR_PUNCTUATION:"pun",PR_SOURCE:"src",PR_STRING:"str",PR_TAG:"tag",PR_TYPE:"typ",prettyPrintOne:function(t,e,i){i=i||!1,e=e||null;var n=document.createElement("div");return n.innerHTML="<pre>"+t+"</pre>",n=n.firstChild,i&&r(n,i,!0),c({j:e,m:i,h:n,l:1,a:null,i:null,c:null,g:null}),n.innerHTML},prettyPrint:g=function(t,e){function i(){for(var e=a.PR_SHOULD_USE_CONTINUATION?p.now()+250:1/0;f<o.length&&p.now()<e;f++){for(var s=o[f],h=v,d=s;d=d.previousSibling;){var u=d.nodeType,w=(7===u||8===u)&&d.nodeValue;if(w?!/^\??prettify\b/.test(w):3!==u||/\S/.test(d.nodeValue))break;if(w){h={},w.replace(/\b(\w+)=([\w:.%+-]+)/g,function(t,e,i){h[e]=i});break}}if(d=s.className,(h!==v||g.test(d))&&!$.test(d)){for(u=!1,w=s.parentNode;w;w=w.parentNode)if(b.test(w.tagName)&&w.className&&g.test(w.className)){u=!0;break}if(!u){var x;if(s.className+=" prettyprinted",u=h.lang,u||(u=d.match(m),!u&&(x=n(s))&&y.test(x.tagName)&&(u=x.className.match(m)),u&&(u=u[1])),_.test(s.tagName))w=1;else{w=s.currentStyle;var S=l.defaultView;w=(w=w?w.whiteSpace:S&&S.getComputedStyle?S.getComputedStyle(s,null).getPropertyValue("white-space"):0)&&"pre"===w.substring(0,3)}S=h.linenums,(S="true"===S||+S)||(S=!!(S=d.match(/\blinenums\b(?::(\d+))?/))&&(!S[1]||!S[1].length||+S[1])),S&&r(s,S,w),c({j:u,h:s,m:S,l:w,a:null,i:null,c:null,g:null})}}}f<o.length?a.setTimeout(i,250):"function"==typeof t&&t()}for(var s=e||document.body,l=s.ownerDocument||document,o=(s=[s.getElementsByTagName("pre"),s.getElementsByTagName("code"),s.getElementsByTagName("xmp")],[]),h=0;h<s.length;++h)for(var d=0,u=s[h].length;d<u;++d)o.push(s[h][d]);s=null;var p=Date;p.now||(p={now:function(){return+new Date}});var f=0,m=/\blang(?:uage)?-([\w.]+)(?!\S)/,g=/\bprettyprint\b/,$=/\bprettyprinted\b/,_=/pre|xmp/i,y=/^code$/i,b=/^(?:pre|code|xmp)$/i,v={};i()}};p=a.define,"function"==typeof p&&p.amd&&p("google-code-prettify",[],function(){return x})}(),g);m||i.setTimeout(e,0)}();export class MDEditor{constructor(t){const e=null==t||null==t.id||t.id.$$mt?"md-editor":t.id,i=null==t||null==t.style?{backgroundColor:"#0000ff1a",color:"#0000ff",placeholder:"Type here ...",placeholderColor:"#bfbfbf",showRow:1}:t.style,n=`\n#${e}>div.inputFocus {\nbackground-color: ${null==i.backgroundColor?"#0000ffia":i.backgroundColor};\ncolor: ${null==i.color?"#0000ff":i.color};\n}\n#${e}>div:nth-last-child(1):empty::after {\ncontent: "${null==i.placeholder?"輸入內容":i.placeholder}";\ncolor: ${null==i.placeholderColor?"#bfbfbf":i.placeholderColor};\n}`;var s=document.createElement("style");s.innerText=n,document.head.appendChild(s),this.body=`section#${e}.md-editor`._({"data-row":i.showRow?1:0}),this.back=[],this.forward=[],this.cursor={check:!1,selection:{},multi:{start:{},end:{}}},this.selection={},this.timer,this.body._mouseup(t=>{this.$cursor()})._touchend(t=>{this.$cursor()})._cut(t=>(this.$selection(()=>{t.clipboardData.setData("text/plain",this.selection.body),this.body.$child(this.selection.start).innerHTML=`${this.selection.left}${this.selection.right}`.$html,this.selection_(),this.focusInput(this.body.$child(this.selection.start),this.selection.left.length)}),this._ADD_HISTORY(!0),!1))._paste(t=>{const e=(t.clipboardData||window.clipboardData).getData("Text");return this.$selection(t=>{const i=e.$ary(/\n/),n=i.$len,s=n-1,l=n>1,r=t.start+s,o=`${l?"":t.left}${i[s]}`.$len;if(this.body.$child(t.start).innerText=`${t.left}${i[0]}${l?"":t.right}`,this.selection_(),l)for(let e=1;e<n;e++){const n=i[e];this.body._child("div"._(`${n}${e===s?t.right:""}`.$html)._click(()=>this.$cursor()),this.body.$child(t.start+e))}this.focusInput(this.body.$child(r),o,o)}),this._ADD_HISTORY(!0),!1})._input(t=>{clearTimeout(this.timer);let e=void 0,i=void 0;"deleteCompositionText"===t.inputType&&(e=this.cursor.index,i=this.cursor.offset,this.body.$childAll.forEach(t=>{"DIV"!==t.nodeName&&(t.remove(),this.body.insertBefore("div"._({index:e+1})._click(()=>this.$cursor()),this.body.$child(e)),this.focusInput(this.body.$child(e),i))})),t.inputType,this.$cursor(),this.timer=setTimeout(()=>{this._ADD_HISTORY(!0)},300)})._keydown(t=>{var e=event.metaKey||event.ctrlKey,i="z"===event.key;return(!e||!i)&&(this.$cursor(),"Tab"===t.key?this._KEYDOWN_TAB(t):"Enter"===t.key?this._KEYDOWN_RETURN(t):"Backspace"===t.key?this._KEYDOWN_BACKSPACE(t):void 0)})._keyup(t=>{this.body.children&&1===this.body.children.length&&"DIV"!==this.body.firstElementChild.nodeName&&this.init(null,!1),this.$cursor(),this.show&&this.show.init()})._blur(t=>{"div.inputFocus".$&&"div.inputFocus".$.class_("inputFocus")})}get viewer(){return this.show}set viewer(t){this.show=t}$cursor(t){function e(t){if(t)return"md-editor"===t.id?t:"DIV"===t.nodeName&&"md-editor"===t.parentNode.id?t:e(t.parentNode)}var i,n,s=window.getSelection(),l=t||e(s.getRangeAt(0).commonAncestorContainer);"div.inputFocus".$&&"div.inputFocus".$.class_("inputFocus"),l&&l.classList&&l._class("inputFocus"),l===this.body&&(i=Number(e(s.baseNode).$attr("index"))-1,n=Number(e(s.focusNode).$attr("index"))-1);var r=Boolean(l===this.body),o=!r&&Boolean(s.baseOffset!==s.focusOffset),h=Boolean(s.focusOffset>s.baseOffset),c=Boolean(i<n);this.cursor.check=!0,this.cursor.index=r?null:Number(l.$attr("index"))-1,this.cursor.offset=r||o?null:Number(s.focusOffset),this.cursor.left=r||o?null:l.innerText.slice(0,s.focusOffset),this.cursor.right=r||o?null:l.innerText.slice(s.focusOffset,l.innerText.length),this.cursor.isSelection=o,this.cursor.selection.start=o?h?s.baseOffset:s.focusOffset:null,this.cursor.selection.end=o?h?s.focusOffset:s.baseOffset:null,this.cursor.selection.left=o?l.innerText.slice(0,this.cursor.selection.start):null,this.cursor.selection.body=s.toString(),this.cursor.selection.right=o?l.innerText.slice(this.cursor.selection.end,l.innerText.length):null,this.cursor.isMulti=r,this.cursor.multi.start.index=r?c?i:n:null,this.cursor.multi.start.offset=r?c?s.baseOffset:s.focusOffset:null,this.cursor.multi.end.index=r?c?n:i:null,this.cursor.multi.end.offset=r?c?s.focusOffset:s.baseOffset:null,this.cursor.multi.left=r?l.$child(this.cursor.multi.start.index).innerText.slice(0,this.cursor.multi.start.offset):null,this.cursor.multi.right=r?l.$child(this.cursor.multi.end.index).innerText.slice(this.cursor.multi.end.offset,l.innerText.length):null}$selection(t){let e,i,n,s;return this.cursor.isMulti?(e=this.cursor.multi.start.index,i=this.cursor.multi.end.index,n=this.cursor.multi.left,s=this.cursor.multi.right):this.cursor.isSelection?(e=this.cursor.index,i=this.cursor.index,n=this.cursor.selection.left,s=this.cursor.selection.right):null!==this.cursor.index&&null!==this.cursor.offset&&(e=this.cursor.index,i=this.cursor.index,n=this.cursor.left,s=this.cursor.right),this.selection.start=Number(e),this.selection.end=Number(i),this.selection.left=n.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&nbsp;/g," "),this.selection.body=String(this.cursor.selection.body),this.selection.right=s.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&nbsp;/g," "),t({isMulti:Boolean(this.cursor.isMulti),isSel:Boolean(this.cursor.isSelection),start:Number(e),end:Number(i),selected:String(this.cursor.selection.body),left:n.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&nbsp;/g," "),right:s.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&nbsp;/g," ")})}selection_(){for(let t=this.selection.end;t>this.selection.start;t--)this.body.$child(t).remove()}updateRowNum(){this.body.$selAll("div").forEach((t,e)=>{t._attr({index:e+1})})}focusInput(t,e,i){this.updateRowNum(),window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty();var n=window.getSelection(),s=document.createRange(),l=null==e?t.childNodes[0].length:e,r=null==i?l:i;s.selectNode(t),t.childNodes[0]?(s.setStart(t.childNodes[0],l>t.childNodes[0].length?t.childNodes[0].length:l),s.setEnd(t.childNodes[0],r>t.childNodes[0].length?t.childNodes[0].length:r)):(s.setStart(t,0),s.setEnd(t,0)),n.addRange(s),this.$cursor(t)}_KEYDOWN_TAB(t){if(9===t.keyCode)return this.$selection(()=>{const t=`${this.selection.left}`.length+4;this.body.$child(this.selection.start).innerHTML=`${this.selection.left}    ${this.selection.right}`.$html,this.selection_(),this.focusInput(this.body.$child(this.selection.start),t)}),!1}_KEYDOWN_RETURN(t){if(13===t.keyCode)return this.$selection(()=>{this.body.$child(this.selection.start).innerHTML=this.selection.left.$html,this.selection_(),this.body.$parent(1).scrollTop+=32,this.body._child("div"._(this.selection.right.$html)._click(()=>this.$cursor()),this.body.$child(this.selection.start+1)),this.focusInput(this.body.$child(this.selection.start+1),0)}),!1}_KEYDOWN_BACKSPACE(t){if(8===t.keyCode)return this.$selection(t=>{if(t.isMulti||t.isSel)this.body.$child(t.start).innerHTML=`${t.left}${t.right}`.$html,this.selection_(),this.focusInput(this.body.$child(t.start),t.left.length);else if(t.left.length){const e=t.left.slice(0,t.left.length-1);this.body.$child(t.start).innerHTML=`${e}${t.right}`.$html,this.focusInput(this.body.$child(t.start),e.length)}else{if(0===t.start)return;this.body.$child(t.start-1).innerHTML+=t.right.$html,this.body.$child(t.start).$rm(),this.body.$parent(1).scrollTop-=32;const e=this.body.$child(t.start-1).innerText.length-t.right.length;this.focusInput(this.body.$child(t.start-1),e)}}),!1}init(t,e=!0){if(this.body.contentEditable=!0,this.body.innerHTML=null,null!=t){const e=t.replace(/\n*$/,"").split("\n");e.forEach((t,e)=>{var i=t.$html;this.body.appendChild("div"._({index:e+1},i)._click(()=>this.$cursor()))}),this.body.appendChild("div"._({index:e.length+1})._click(()=>this.$cursor())),this.focusInput(this.body.$child(this.cursor.index||0),0)}else this.body.appendChild("div"._({index:1})._click(()=>this.$cursor())),this.focusInput(this.body.firstElementChild,0);e&&this._ADD_HISTORY(!0)}insertToLast(t){this.body.$child(-1).innerText.$$mt?this.body.$child(-1).innerHTML=t.$html:this.body._child(["div"._(t.$html)._click(()=>this.$cursor())]),this.body.scrollTop=this.body.scrollHeight}updateContent(t,e){this.body.$child(this.selection.start).innerHTML=t.$html,this.selection_(),this.focusInput(this.body.$child(this.selection.start),e),this.show&&this.show.init()}_ADD_HISTORY(t){this.back.push(this.getTxt()),t&&(this.forward=[])}goBack(){const t=this.back.$(-2);if(null!=t){let e=this.back.pop();this.forward.push(e),this.init(t.length<1?null:t,!1),this.show&&this.show.init()}}goForward(){const t=this.forward.pop();null!=t&&(this.back.push(t),this.init(t,!1),this.show&&this.show.init())}addHeading(t,e){const i=t.metaKey||t.ctrlKey,n=`${new Array(e).fill("#").join("")}${0===e?"":" "}`;this.cursor.check?this.$selection(()=>{const t=this.selection.left.replace(/^\s*\#*\s*/,""),s=this.selection.body,l=this.selection.right,r=`${i?`<h${e}>`:n}${t}${s}${l}${i?`</h${e}>`:""}`.replace(/\n/g,""),o=r.length-(i?5:0);this.updateContent(r.$html,o),this._ADD_HISTORY(!0)}):(this.insertToLast((i?`<h${e}></h${e}>`:n).$html),this.focusInput(this.body.$child(-1),n.length-(i?5:0)),this._ADD_HISTORY(!0))}addBold(t){const e=t.metaKey||t.ctrlKey;this.cursor.check?this.$selection(()=>{const t=this.selection.left,i=this.selection.body,n=this.selection.right,s=`${t}${e?"<b>":"**"}${i}${e?"</b>":"**"}${n}`.replace(/\n/g,""),l=s.length-n.length-(e?4:2);this.updateContent(s.$html,l),this._ADD_HISTORY(!0)}):(this.insertToLast((e?"<b></b>":"****").$html),this.focusInput(this.body.$child(-1),e?4:2),this._ADD_HISTORY(!0))}addItalic(t){const e=t.metaKey||t.ctrlKey;this.cursor.check?this.$selection(()=>{const t=this.selection.left,i=this.selection.body,n=this.selection.right,s=`${t}${e?"<i>":"*"}${i}${e?"</i>":"*"}${n}`.replace(/\n/g,""),l=s.length-n.length-(e?4:1);this.updateContent(s.$html,l),this._ADD_HISTORY(!0)}):(this.insertToLast((e?"<i></i>":"**").$html),this.focusInput(this.body.$child(-1),e?4:1),this._ADD_HISTORY(!0))}addStrikethrough(t){const e=t.metaKey||t.ctrlKey;this.cursor.check?this.$selection(()=>{const t=this.selection.left,i=this.selection.body,n=this.selection.right,s=`${t}${e?"<s>":"~~"}${i}${e?"</s>":"~~"}${n}`.replace(/\n/g,""),l=s.length-n.length-(e?4:2);this.updateContent(s.$html,l),this._ADD_HISTORY(!0)}):(this.insertToLast((e?"<s></s>":"~~~~").$html),this.focusInput(this.body.$child(-1),e?4:2),this._ADD_HISTORY(!0))}addUnderline(t){const e=t.metaKey||t.ctrlKey;this.cursor.check?this.$selection(()=>{const t=this.selection.left,i=this.selection.body,n=this.selection.right,s=`${t}${e?"<u>":"__"}${i}${e?"</u>":"__"}${n}`.replace(/\n/g,""),l=s.length-n.length-(e?4:2);this.updateContent(s.$html,l),this._ADD_HISTORY(!0)}):(this.insertToLast((e?"<u></u>":"____").$html),this.focusInput(this.body.$child(-1),e?4:2),this._ADD_HISTORY(!0))}addMarker(t){const e=t.metaKey||t.ctrlKey;this.cursor.check?this.$selection(()=>{const t=this.selection.left,i=this.selection.body,n=this.selection.right,s=`${t}${e?"<mark>":"=="}${i}${e?"</mark>":"=="}${n}`.replace(/\n/g,""),l=s.length-n.length-(e?7:2);this.updateContent(s.$html,l),this._ADD_HISTORY(!0)}):(this.insertToLast((e?"<mark></mark>":"====").$html),this.focusInput(this.body.$child(-1),e?7:2),this._ADD_HISTORY(!0))}addBlockquote(){this.cursor.check?this.$selection(()=>{for(let t=this.selection.start;t<=this.selection.end;t++){const e=this.body.$child(t);e.innerHTML=`> ${e.innerText}`.$html}const t=this.body.$child(this.selection.end),e=t.innerText.length;this.focusInput(t,e),this.show&&this.show.init(),this._ADD_HISTORY(!0)}):(this.insertToLast("> ".$html),this.focusInput(this.body.$child(-1),2),this._ADD_HISTORY(!0))}addUl(){this.cursor.check?this.$selection(()=>{for(let t=this.selection.start;t<=this.selection.end;t++){const e=this.body.$child(t);e.innerHTML=`- ${e.innerText}`.$html}const t=this.body.$child(this.selection.end),e=t.innerText.length;this.focusInput(t,e),this.show&&this.show.init(),this._ADD_HISTORY(!0)}):(this.insertToLast("- ".$html),this.focusInput(this.body.$child(-1),2),this._ADD_HISTORY(!0))}addOl(){this.cursor.check?this.$selection(()=>{var t=1;if(this.selection.start-1>=0){var e=/^\s*(\d+)?\.\s/,i=this.body.$child(this.selection.start-1).innerText;e.test(i)&&(t=Number(i.match(e)[1])+1),this.body.$child(this.selection.start).innerHTML=this.body.$child(this.selection.start).innerText.replace(e,"").$html}for(let e=0;e<=this.selection.end-this.selection.start;e++){var n=Number(this.selection.start+e),s=Number(t+e);i=String(this.body.$child(n).innerText);this.body.$child(n).innerHTML=`${s}. ${i}`.$html}var l=this.body.$child(this.selection.end+1);l&&!l.innerText.$$mt&&this.body.insertBefore("div"._()._click(()=>this.$cursor()),this.body.$child(this.selection.end+1)),
this.focusInput(this.body.$child(this.selection.end),this.body.$child(this.selection.end).innerText.length),this.show&&this.show.init(),this._ADD_HISTORY(!0)}):(this.insertToLast("1. ".$html),this.focusInput(this.body.$child(-1),3),this._ADD_HISTORY(!0))}addCode(){this.cursor.check?this.$selection(()=>{if(this.cursor.isMulti)this.body._child("div"._("```")._click(()=>this.$cursor()),this.body.$child(this.selection.end+1)),this.body._child("div"._("```")._click(()=>this.$cursor()),this.body.$child(this.selection.start)),this.focusInput(this.body.$child(this.selection.end+1),this.body.$child(this.selection.end+1).innerText.length),this.show&&this.show.init();else if(this.cursor.isSelection){const t=`${this.selection.left}\`${this.selection.body}\`${this.selection.right}`.replace(/\n/g,""),e=t.length-this.selection.right.length-3;this.updateContent(t.$html,e)}else{const t=`${this.selection.left}\`\`${this.selection.right}`.replace(/\n/g,""),e=this.selection.left.length+3;this.updateContent(t.$html,e)}this._ADD_HISTORY(!0)}):(this.insertToLast("```"),this.insertToLast(""),this.insertToLast("```"),this.focusInput(this.body.$child(-1),0),this._ADD_HISTORY(!0))}addLink(t,e){if(e.$$mt)return;if(this.cursor.check)return void this.$selection(i=>{const n=this.selection.left,s=this.selection.right,l=`${n} [${t}](${e}) ${s}`.replace(/\n/g,""),r=l.length-s.length-1;this.updateContent(l.$html,r),this._ADD_HISTORY(!0)});this.insertToLast(`[${t}](${e})`.$html);const i=this.body.$child(-1),n=i.innerText.length;this.focusInput(i,n),this.show&&this.show.init(),this._ADD_HISTORY(!0)}addImage(t,e,i){if(t.$$mt)return;const n=i.$$mt?"":` "${i}"`;if(this.cursor.check)return void this.$selection(i=>{const s=this.selection.left,l=this.selection.right,r=`${s} ![${e}](${t}${n}) ${l}`.replace(/\n/g,""),o=r.length-l.length-1;this.updateContent(r.$html,o),this._ADD_HISTORY(!0)});this.insertToLast(`![${e}](${t}${n})`.$html);const s=this.body.$child(-1),l=s.innerText.length;this.focusInput(s,l),this.show&&this.show.init(),this._ADD_HISTORY(!0)}clear(){this.init(),this.show&&this.show.init()}downloadMd(){let t="Markdown-Editor.md",e=this.getMdTxt(),i=new Blob([e],{type:"application/octet-stream"}),n=URL.createObjectURL(i),s="a"._({href:n,download:t});_child(s),s.click()}downloadHtml(){let t="Markdown-Editor.html",e=`<!DOCTYPE html>\n<html lang="zh-hant">\n<head>\n<meta charset="UTF-8">\n<meta http-equiv="X-UA-Compatible" content="IE=edge">\n<meta name="viewport" content="width=device-width, initial-scale=1.0">\n<title>Markdown Editor</title>\n<link rel="stylesheet" href="https://pardnchiu.github.io/markdown-editor/css/index.min.css">\n<script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js"></script>\n</head>\n<body>\n<section id="PDMDViewer">\n${`\n${this.getMdTxt()}\n`.replace(/[\n]{3,}/g,"\n\n\n").mdToHtml().replace(/\$ELM/g,"")}\n</section>\n</body>\n</html>`,i=new Blob([e],{type:"application/octet-stream"}),n=URL.createObjectURL(i),s="a"._({href:n,download:t});_child(s),s.click()}openfile(t){if(t){let e=new FileReader;e.readAsText(t),e.onload=(()=>{this.body.innerHTML=null,e.result.split("\n").forEach((t,e)=>{var i=t.replace(/ | /g,"&nbsp;").replace(/</g,"&lt;").replace(/\>/g,"&gt;");this.body.appendChild("div"._({index:e+1},i)._click(()=>this.$cursor()))}),this.show&&this.show.init(e.result)})}else alert("請選擇檔案")}getTxt(){let t=this.body.$childAll.map(t=>t.innerText).join("\n");return t}getMdTxt(){let t=this.body.$childAll.map(t=>t.innerText.trim()).join("\n");return`\n${t.trim()}\n`}}((t,e)=>{const i="mdH",n="mdS",s="mdU",l="mdStrongEm",r="mdStrong",o="mdMark",h="mdSuper",c="mdSub",a="mdEm",d="mdTag",u="mdFont",p="mdImg",f="mdA",m="mdLink",g="mdOriginURL",$="mdOriginEmail",_="mdUlOl",y="mdList",b="mdCodeMulti",v="mdCodeTab",w="mdCodeSingle",x="mdCode",S="mdTable",T="mdHr",C="htmlBr",k=/(\n[\u00A0\u0020]*)\\?(\#{1,6})[\u00A0\u0020]+([^\n]+)/,A=new RegExp(k,"g"),E=/\n([^\n]+)\n\={3,}[\u00A0\u0020]*\n/,N=new RegExp(E,"g"),R=/\n([^\n]+)\n\-{3,}[\u00A0\u0020]*\n/,D=new RegExp(R,"g"),I=/\~{2}([^\n\~]+?)\~{2}/,L=new RegExp(I,"g"),O=/\_{2}([^\n\_]+?)\_{2}/,M=new RegExp(O,"g"),H=/\*{3}([^\n\*]+?)\*{3}/,j=new RegExp(H,"g"),B=/\*{2}([^\n\*]+?)\*{2}/,Y=new RegExp(B,"g"),K=/\={2}([^\n]+?)\={2}/,U=new RegExp(K,"g"),P=/\^{1}([^\n\^]+?)\^{1}/,z=new RegExp(P,"g"),F=/\~{1}([^\n]+?)\~{1}/,V=new RegExp(F,"g"),q=/\_([^\n\_]+?)\_/,Z=new RegExp(q,"g"),G=/\*([^\n\*]+?)\*/,W=new RegExp(G,"g"),Q=/\!\[([^\]]+)?\]\(([^\)]+)\)(\(([0-9]+\%?)?(\s|\*|x)+([0-9]+\%?)?\))?/,X=new RegExp(Q,"g"),J=/[\"\(]{0,1}(https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*))[\"\)]{0,1}/,tt=new RegExp(J,"g"),et=/[\"\(]{0,1}(\w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*)[\"\)]{0,1}/,it=new RegExp(et,"g");t(e,i,{value:function(){let t=this.toString();return(e=>{let i=t.$fit(A)||[];for(let e=0,n=i[e];e<i.length;e++,n=i[e]){if(n.$fit(/^\\/))continue;const e=n.$fit(k),i=e[1],s=e[2],l=e[3];if(null==i||null==s||null==l)continue;const r="temp"._([`h${s.length}`._(l.trim())]);t=t.__(n,i+r.$str)}})(),(e=>{let i=t.$fit(N)||[];for(let e=0,n=i[e];e<i.length;e++,n=i[e]){const e=n.$fit(E),i=e[1];if(null==i)continue;const s="temp"._(["h1"._(i.trim())]);t=t.__(n,`\n${s.$str}\n`)}})(),(e=>{let i=t.$fit(D)||[];for(let e=0,n=i[e];e<i.length;e++,n=i[e]){const e=n.$fit(R),i=e[1];if(null==i)continue;const s="temp"._(["h2"._(i.trim())]);t=t.__(n,`\n${s.$str}\n`)}})(),t}}),t(e,n,{value:function(){let t=this.toString(),e=t.$fit(L)||[];for(let i=0,n=e[i];i<e.length;i++,n=e[i]){const e=n.$fit(I),i=e[1];if(null==i)continue;const s="temp"._(["s"._(i.trim())]);t=t.__(n,s.$str)}return t}}),t(e,s,{value:function(){let t=this.toString(),e=t.$fit(M)||[];for(let i=0,n=e[i];i<e.length;i++,n=e[i]){const e=n.$fit(O),i=e[1];if(null==i)continue;const s="temp"._(["u"._(i.trim())]);t=t.__(n,s.$str)}return t}}),t(e,l,{value:function(){let t=this.toString(),e=t.$fit(j)||[];for(let i=0,n=e[i];i<e.length;i++,n=e[i]){const e=n.$fit(H),i=e[1];if(null==i)continue;const s="temp"._(["strong"._(["em"._([i.trim()])])]);t=t.__(n,s.$str)}return t}}),t(e,r,{value:function(){let t=this.toString(),e=t.$fit(Y)||[];for(let i=0,n=e[i];i<e.length;i++,n=e[i]){const e=n.$fit(B),i=e[1];if(null==i)continue;const s="temp"._(["strong"._(i.trim())]);t=t.__(n,s.$str)}return t}}),t(e,o,{value:function(){let t=this.toString(),e=t.$fit(U)||[];for(let i=0,n=e[i];i<e.length;i++,n=e[i]){const e=n.$fit(K),i=e[1];if(null==i)continue;const s="temp"._(["mark"._(i.trim())]);t=t.__(n,s.$str)}return t}}),t(e,h,{value:function(){let t=this.toString(),e=t.$fit(z)||[];for(let i=0,n=e[i];i<e.length;i++,n=e[i]){const e=n.$fit(P),i=e[1];if(null==i)continue;const s="temp"._(["sup"._(i.trim())]);t=t.__(n,s.$str)}return t}}),t(e,c,{value:function(){let t=this.toString(),e=t.$fit(V)||[];for(let i=0,n=e[i];i<e.length;i++,n=e[i]){const e=n.$fit(F),i=e[1];if(null==i)continue;const s="temp"._(["sub"._(i.trim())]);t=t.__(n,s.$str)}return t}}),t(e,a,{value:function(){let t=this.toString();return(e=>{let i=t.$fit(Z)||[];for(let e=0,n=i[e];e<i.length;e++,n=i[e]){const e=n.$fit(q),i=e[1];if(null==i)continue;const s="temp"._(["em"._(i.trim())]);t=t.__(n,s.$str)}})(),(e=>{let i=t.$fit(W)||[];for(let e=0,n=i[e];e<i.length;e++,n=i[e]){const e=n.$fit(G),i=e[1];if(null==i)continue;const s="temp"._(["em"._(i.trim())]);t=t.__(n,s.$str)}})(),t}}),t(e,d,{value:function(){let t=this.toString();if(String(tag_path||"").trim().length<1)return t;const e=/(\s{1})\\?[\#＃]{1}([\u4e00-\u9fff\u3040-\u30ff\uac00-\ud7a3a-zA-Z0-9_]+)/,i=new RegExp(e,"g");let n=t.$fit(i)||[];for(let i=0,s=n[i];i<n.length;i++,s=n[i]){if(s.$fit(/^\\/))continue;const i=s.$fit(e),n=i[1],l=i[2];if(null==l)continue;const r="temp"._(["_blank"===tag_target?"a.tag"._(l.trim())._open(tag_path+l.trim()):"a.tag"._(l.trim())._go(tag_path+l.trim())]);t=t.__(s,n+r.$str)}return t}}),t(e,u,{value:function(){let t=this.toString();return t.mdS().mdU().mdStrongEm().mdStrong().mdMark().mdSuper().mdSub().mdEm().mdTag()}}),t(e,p,{value:function(){let t=this.toString(),e=t.$fit(X)||[];for(let i=0,n=e[i];i<e.length;i++,n=e[i]){const e=n.$fit(Q),i=e[1],s=e[2],l=e[4],r=e[6];if(null==s)continue;const o=s.trim().split(/[\u00A0\u0020]+/).filter(t=>t.trim().length);if(o.length<1)continue;const h=o[0].trim(),c=String(o[1]||"").__(/\"/g,"").trim(),a=String(i||"").trim(),d=String(l||"").trim(),u=String(r||"").trim(),p=randomKey(),f=h.$$(/\.mov$/),m=h.$$(/\.mp4$/),g=h.$$(/\.svg$/);let $;$=f?"temp"._(["video"._({controls:"",title:c,width:d,height:u},["source"._({type:"video/quicktime"},h)])]):m?"temp"._(["video"._({controls:"",title:c,width:d,height:u},["source"._({type:"video/mp4"},h)])]):g?"temp"._(["img"._({alt:a,title:c,width:d,height:u},h)]):"temp"._(["figure"._(["img"._({alt:a,title:c,width:d,height:u},h),"figcaption"._(c),"a.photo"._()._open(h)])]),keyMap.set(p,$.$str),t=t.__(n,` ${p} `)}return t}}),t(e,g,{value:function(){let t=this.toString(),e=t.$fit(tt)||[];for(let i=0,n=e[i];i<e.length;i++,n=e[i]){if(n.$fit(/^(\"|\()/)&&n.$fit(/(\)|\")$/))continue;n=n.replace(/^(\"|\()/,"").replace(/(\)|\")$/,"");const e=String(n.$fit(J)[0]||"").trim().__(/\/$/,""),i=randomKey(),s="temp"._(["a"._(e)._open(e)]);-1===url_ary.indexOf(e)&&e.$fit(J)&&url_ary.push(e),keyMap.set(i,s.$str),t=t.__(n,` ${i} `)}return t}}),t(e,$,{value:function(){let t=this.toString(),e=t.$fit(it)||[];for(let i=0,n=e[i];i<e.length;i++,n=e[i]){if(n.$fit(/^(\"|\()/)&&n.$fit(/(\)|\")$/))continue;n=n.replace(/^(\"|\()/,"").replace(/(\)|\")$/,"");const e=n.$fit(et)[0],i=randomKey(),s="temp"._(["a"._(e)._open("mailto:"+e)]);keyMap.set(i,s.$str),t=t.__(n,` ${i} `)}return t}}),t(e,f,{value:function(){let t=this.toString();const e=/\[([^\]]+)?\]\(([^\)]+)\)/g,i=/\[([^\]]+)?\]\(([^\)]+)\)/;t.$$(e)&&t.$fit(e).forEach(e=>{const n=e.$fit(i)[1],s=e.$fit(i)[2],l=null==n?"":n.trim(),r=null==s?["",""]:s.trim().split(/[\u00A0\u0020]+/),o=String(r[0]||"").trim().__(/\/$/,""),h=null==r[1]?"":r[1].__(/\"/g,"").trim(),c=randomKey();-1===url_ary.indexOf(o)&&o.$fit(J)&&url_ary.push(o);const a="temp"._(["a.link"._({title:h},l)._open(o)]);keyMap.set(c,a.$str),t=t.__(e,` ${c} `)});const n=/[\"]{0,1}(https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*))[\"]{0,1}/g,s=/[\"]{0,1}(https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*))[\"]{0,1}/;return t.$$(n)&&t.$fit(n).forEach(e=>{if(e.$fit(/^\"/)&&e.$fit(/\"$/))return;const i=String(e.$fit(s)[0]||"").trim().__(/\/$/,""),n=randomKey(),l="temp"._(["a"._(i)._open(i)]);-1===url_ary.indexOf(i)&&i.$fit(J)&&url_ary.push(i),keyMap.set(n,l.$str),t=t.__(e,` ${n} `)}),t}}),t(e,m,{value:function(){let t=this.toString();return t.mdImg().mdA()}}),t(e,_,{value:function(t,e){let i=this.toString();const n="UL"===t,s=n?/(\n[\u00A0\u0020]{0,3}[\-\*\+]{1}\s+.+(\n[\u00A0\u0020]+.+)*)+/g:/(\n[\u00A0\u0020]{0,3}\d+\.{1}\s+.+(\n[\u00A0\u0020]+.+)*)+/g;return i=i.mdCodeMulti(!0),s.test(i)&&i.match(s).forEach(s=>{let l=s.__(/(\<br\>|\n)/g,"\n").mdCodeSingle().mdH().mdLink().mdFont().trim();keyMap.forEach((t,e)=>{var i=new RegExp(e);l=l.__(i,t)}),l=l.split(/\n/);let r="temp"._();if(l.forEach(e=>{const i=n?/^[\u00A0\u0020]{0,3}[\-\*\+]/:/^[\u00A0\u0020]{0,3}\d+\./,s=n?/^[\u00A0\u0020]{4,}[\-\*\+]/:/^[\u00A0\u0020]{4,}\d+\./,l=/^[\u00A0\u0020]{1,}/,o=e.match(/[\u00A0\u0020]{4}/g),h=null!=o?o.length:0,c=e.__(n?/^[\-\*\+\u00A0\u0020]+/g:/^[\u00A0\u0020]*\d+\./g,"").trim();let a=r;if(i.test(e))a.appendChild("li"._(c));else if(s.test(e)){for(let e=0;e<h&&(null!=a.lastChild&&null!=a.lastChild.tagName);e++)a.lastChild.lastChild.tagName!==t&&a.lastChild.appendChild(t._()),a=a.lastChild.lastChild;a.appendChild("li"._(c))}else if(l.test(e)){for(let e=0;e<h&&null!=a.lastChild;e++)0===e&&"LI"===a.lastChild.tagName?a=a.lastChild:"LI"===a.tagName&&a.lastChild.tagName===t&&"LI"===a.lastChild.lastChild.tagName&&(a=a.lastChild.lastChild);"LI"!==a.tagName||a.lastChild.tagName===t||null!=a.lastChild.tagName&&!/^(IMG|A|B|STRONG|MARK|I|EM|U|S|CODE)/i.test(a.lastChild.tagName)||a.appendChild(document.createElement("br")),a.innerHTML+=c}}),e)i=i.__(s,`\n<${t}>${r.$str}</${t}>\n`);else{var o=`<${t}>${r.$str}</${t}>`,h=randomKey();keyMap.set(h,o),i=i.__(s,`\n${h}\n`)}}),i}}),t(e,y,{value:function(t){let e=this.toString();return e.mdUlOl("UL",t).mdUlOl("OL",t)}}),t(e,b,{value:function(t){const e=/\`{3}[\s\S]*?\`{3}/g,i="javascript js ts html css xml json sql java python ruby php cpp csharp swift typescript kotlin go rust perl bash".split(/\s/);let n=this.toString();return e.test(n)&&n.match(e).forEach((e,s)=>{let l=[];e.split(/\n/).forEach(t=>{let e=Math.floor(t.match(/^[\u00A0\u0020]*/)[0].length/4);l.push(e)});const r=l.$(-1),o=new RegExp(`^\\s{0,${4*r}}`),h=e.match(/^\`{3}[\u00A0\u0020]*(\w*)?/)[1],c=null==h?"":h.toLocaleLowerCase(),a=i.filter(t=>t===c).length,d=1===e.split(/\n/).length,u=randomKey();let p="";p=d?e.__(/\`{3}\s*|\s*\`{3}/g,""):e.__(/^\`{3}[\u00A0\u0020]*\w*\n*|\s*\`{3}$/g,"").split(/\n/).map(t=>`<li>${t.__(o,"").$html}</li>`).join("");const f="temp"._([d?"code.prettyprint"._(p):"pre.prettyprint"._({name:c},[`code.multi${a?`.language-${c}`:""}`._({name:c},["ol"._(p)]),"button.copy"._("複製代碼")])]);keyMap.set(u,f.$str),n=n.__(e,`${t?" ":"\n"}${u}\n`)}),n}}),t(e,v,{value:function(){const t=/(\n[\u00A0\u0020]{4,}[^\n]+)+/g;let e=this.toString();return t.test(e)&&e.match(t).forEach(t=>{const i=randomKey(),n=t.__(/^[\u00A0\u0020]{4}/g,"").__(/\n[\u00A0\u0020]{4}/g,"\n").trim().split("\n").map(t=>`<li>${t.__(/\s/g,"&nbsp;").$html}</li>`).join(""),s="temp"._(["pre.prettyprint"._(["code.multi"._(["ol"._(n)]),"button.copy"._("複製代碼")])]);keyMap.set(i,s.$str),e=e.__(t,`\n${i}`)}),e}}),t(e,w,{value:function(t){const e=/\`[^\n]+?\`/g;let i=this.toString();return e.test(i)&&i.match(e).forEach(e=>{const n=randomKey(),s=e.__(/\`{1}\s*|\s*\`{1}/g,""),l="temp"._(["code.prettyprint"._(s)]);t?i=i.__(e,l.$str):(keyMap.set(n,l.$str),i=i.__(e,n))}),i}}),t(e,x,{value:function(){let t=this.toString();return t.mdCodeTab().mdCodeSingle()}}),t(e,S,{value:function(){const t=/(\|((?:.*?\|)*.*)\|[\u00A0\u0020]*\n)+/g,e=/\|([\u00A0\u0020]*\:?\-+\:?[\u00A0\u0020]*\|)+/;let i=this.toString();return t.test(i)&&i.match(t).forEach(t=>{let n=!0,s="",l="",r="",o="",h=0;const c=t.trim().split(/\n/);c.forEach((t,i)=>{if(e.test(t))return s=`<thead>${r}</thead>`,n=!1;if(n){let e="";h=t.trim().__(/^\|\s*|\s*\|$/g,"").split(/\s*\|\s*/).length,t.trim().__(/^\|\s*|\s*\|$/g,"").split(/\s*\|\s*/).forEach(t=>{const i=t.trim().mdH().mdLink().mdFont();e+=`<td>${i}</td>`}),r+=`<tr>${e}</tr>`}else{let e="",i=t.__(/^\|\s*|\s*\|$/g,"").split(/\s*\|\s*/);for(let t=0;t<h;t++){const n=(null==i[t]?"":i[t]).trim().mdCodeSingle(!0).mdH().mdLink().mdFont();e+=`<td>${n}</td>`}o+=`<tr>${e}</tr>`}i===c.length-1&&(l=`<tbody>${o}</tbody>`)});const a=`<table>${s}${l}</table>`,d=randomKey();keyMap.set(d,a),i=i.__(t,`\n${d}\n`)}),i}}),t(e,T,{value:function(){const t=/\n[\u00A0\u0020]*(\*{3,}|\-{3,})\B/g;let e=this.toString();return t.test(e)&&(e=e.__(t,"\n<hr>\n")),e}}),t(e,C,{value:function(){var t=String(this).__(/^\n*|\n*$/g,""),e=/(&lt;br&gt;)/g,i=e.test(this);return i?t.__(e,"\n"):t}})})(Object.defineProperty,String.prototype);const keys="abcdefghijklmnopqrstuvwxyz0123456789".split("");let keyMap=new Map,url_ary=[];String.prototype.mdToHtml=function(){let t=this.toString().__(/[\u00A0\u0020]/g," ").mdTable().mdBlockquote().mdList().mdCode().mdH().mdLink().mdOriginURL().mdOriginEmail().mdFont().mdHr().htmlBr();for(;t.$$(/\{{2}\w{64}\}{2}/);)t.$fit(/\{{2}\w{64}\}{2}/g).forEach(e=>{let i=new RegExp(e);t=t.replace(i,keyMap.get(e))});return t},String.prototype.mdBlockquote=function(){let t=this.toString();const e=/\n(\>[\u00A0\u0020\>]+[^\n]*\n?)+/g;return e.test(t)&&t.match(e).forEach(e=>{function i(t){let e="temp"._();const n=/^[\u00A0\u0020]*\>/,s=t.replace(n,"");if(n.test(t)){let t="blockquote"._();t._child([i(s)]),e._child([t])}else e._child(["span"._(t),"br"._()]);return e}const n=randomKey(),s=e.trim().replace(/^\>[\u00A0\u0020]?/g,"").replace(/\n\>[\u00A0\u0020]?/g,"\n").mdList(!0).mdCodeSingle(!0).mdFont().mdLink().split(/\n/);let l="temp"._();s.forEach(t=>{l._child([i(t)])});const r="temp"._(["blockquote"._(l.$str)]);keyMap.set(n,r.$str),t=t.replace(e,`\n${n}\n\n`)}),t};